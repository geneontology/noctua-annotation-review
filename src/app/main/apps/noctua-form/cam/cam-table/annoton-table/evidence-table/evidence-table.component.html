<div class="noc-evidence-table w-100-p">
  <table mat-table fxFlex="1 1 auto" class="w-100-p" #table [dataSource]="entity.predicate?.evidence">
    <ng-container matColumnDef="evidence">
      <th mat-header-cell *matHeaderCellDef class="noc-column-flex" fxFlex="" fxLayout="row"
        fxLayoutAlign="start center">Evidence</th>
      <td mat-cell *matCellDef="let evidence; let i = index;" class="noc-column-flex" fxFlex="" fxLayout="column"
        fxLayoutAlign="start stretch" [ngClass]="{'noc-highlight-modified': evidence.evidence?.modified}">
        <p class="noc-old-term" *ngIf="evidence.evidence?.modified && evidence.evidence?.termHistory?.length>0">
          {{evidence.evidence?.termHistory[0]?.label}}
          <a (click)="$event.stopPropagation()" href="{{evidence.evidence?.termHistory[0]?.url}}" target="_blank">
            {{ evidence.evidence?.termHistory[0]?.id }}
          </a>
        </p>
        <p class="">{{evidence.evidence?.label}}<br>
          <a (click)="$event.stopPropagation()" href="{{evidence.evidence?.url}}" target="_blank">
            {{ evidence.evidence?.id }}
          </a>
        </p>
        <noctua-inline-editor *ngIf="noctuaUserService.user && options.editableEvidence" [cam]="cam" [annoton]='annoton'
          [entity]="entity" [category]="EditorCategory.evidence" [evidenceIndex]="i" class="noc-edit-button">
        </noctua-inline-editor>
      </td>
    </ng-container>
    <ng-container matColumnDef="reference">
      <th mat-header-cell *matHeaderCellDef fxFlex="120px" fxLayout="row" fxLayoutAlign="start center">Reference
      </th>
      <td mat-cell *matCellDef="let evidence; let i = index" fxFlex="120px" fxLayout="column"
        fxLayoutAlign="start stretch" [ngClass]="{'noc-highlight-match': evidence.referenceEntity?.highlight,
            'noc-highlight-modified': evidence.referenceEntity?.modified,
            'noc-highlight-match-current': evidence.referenceEntity?.uuid===camsService.currentMatch?.uuid}">
        <p class="noc-old-term"
          *ngIf="evidence.referenceEntity?.modified && evidence.referenceEntity?.termHistory?.length>0">
          <a (click)="$event.stopPropagation()" href="{{evidence.referenceEntity?.termHistory[0]?.url}}"
            target="_blank">
            {{ evidence.referenceEntity?.termHistory[0]?.id }}
          </a>
        </p>
        <p *ngIf="!evidence.referenceEntity?.url" class="">{{evidence.reference}}</p>
        <p *ngIf="evidence.referenceEntity?.url" class="">
          <a (click)="$event.stopPropagation()" href="{{evidence.referenceEntity?.url}}" target="_blank">
            {{evidence.reference}}
          </a>
        </p>
        <noctua-inline-editor *ngIf="noctuaUserService.user && options.editableReference" [cam]="cam"
          [annoton]='annoton' [entity]="entity" [category]="EditorCategory.reference" [evidenceIndex]="i"
          class="noc-edit-button">
        </noctua-inline-editor>
      </td>
    </ng-container>
    <ng-container matColumnDef="with">
      <th mat-header-cell *matHeaderCellDef fxFlex="120px" fxLayout="row" fxLayoutAlign="start center">With</th>
      <td mat-cell *matCellDef="let evidence; let i = index;" fxFlex="120px" fxLayout="column"
        fxLayoutAlign="start stretch" [ngClass]="{'noc-highlight-modified': evidence.withEntity?.modified}">
        <p class="noc-old-term" *ngIf="evidence.withEntity?.modified && evidence.withEntity?.termHistory?.length>0">
          <a (click)="$event.stopPropagation()" href="{{evidence.withEntity?.termHistory[0]?.url}}" target="_blank">
            {{ evidence.withEntity?.termHistory[0]?.id }}
          </a>
        </p>
        <p *ngIf="!evidence.withEntity?.url" class="">{{evidence.with}}</p>
        <p *ngIf="evidence.withEntity?.url" class="">
          <a (click)="$event.stopPropagation()" href="{{evidence.withEntity?.url}}" target="_blank">
            {{evidence.with}}
          </a>
        </p>
        <noctua-inline-editor *ngIf="noctuaUserService.user && options.editableWith" [cam]="cam" [annoton]='annoton'
          [entity]="entity" [category]="EditorCategory.with" [evidenceIndex]="i" class="noc-edit-button">
        </noctua-inline-editor>
      </td>
    </ng-container>
    <ng-container matColumnDef="assignedBy">
      <th mat-header-cell *matHeaderCellDef fxFlex="120px" fxLayout="row" fxLayoutAlign="start center">Assigned By
      </th>
      <td mat-cell *matCellDef="let evidence; let i = index;" fxFlex="120px" fxLayout="row"
        fxLayoutAlign="start center">
        <p class="">
          <span *ngFor="let group of evidence.groups; let i=index; let isLast=last">
            <a (click)="$event.stopPropagation()" href="{{group.url}}" target="_blank">
              {{group.name}}
            </a>
            <span *ngIf="!isLast">&#44;&nbsp;</span>
          </span>
        </p>
      </td>
    </ng-container>
    <ng-container matColumnDef="contributor">
      <th mat-header-cell *matHeaderCellDef fxFlex="120px" fxLayout="row" fxLayoutAlign="start center">Contributors
      </th>
      <td mat-cell *matCellDef="let evidence; let i = index;" fxFlex="120px" fxLayout="row"
        fxLayoutAlign="start center">
        <p class="">
          <span *ngFor="let contributor of evidence.contributors; let i=index; let isLast=last">
            <a (click)="$event.stopPropagation()" href="{{contributor.urcid}}" target="_blank">
              {{contributor.name}}
            </a>
            <span *ngIf="!isLast">&#44;&nbsp;</span>
          </span>
        </p>
      </td>
    </ng-container>
    <tr mat-header-row [ngClass]="{'noc-hide-header':options.hideHeader}" *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let evidence; columns: displayedColumns;" class="" matRipple></tr>
  </table>
  <div *ngIf="entity.predicate?.evidence.length===0" class="noc-no-info">
    no evidence present.
  </div>
</div>